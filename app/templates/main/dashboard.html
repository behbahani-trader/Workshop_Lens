{% extends "base.html" %}

{% block title %}Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯{% endblock %}

{% block breadcrumb %}
<li class="breadcrumb-item">
    <span class="flex items-center gap-2 text-primary">
        <i class="fas fa-chart-line"></i>
        <span>Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</span>
    </span>
</li>
{% endblock %}



{% block extra_css %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
.chart-container {
    position: relative;
    height: 300px;
    width: 100%;
}
.stat-card {
    background: linear-gradient(135deg, var(--fallback-b1,oklch(var(--b1))), var(--fallback-b2,oklch(var(--b2))));
    border: 1px solid var(--fallback-b3,oklch(var(--b3)));
}
</style>
{% endblock %}

{% block content %}
<!-- ÙÛŒÙ„ØªØ± Ø²Ù…Ø§Ù†ÛŒ -->
<div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold">ğŸ“Š Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù…Ø¯ÛŒØ±ÛŒØªÛŒ</h1>
    <div class="flex gap-2">
        <select id="periodFilter" class="select select-bordered select-sm">
            <option value="7" {% if period == '7' %}selected{% endif %}>Ù‡ÙØªÙ‡ Ø§Ø®ÛŒØ±</option>
            <option value="30" {% if period == '30' %}selected{% endif %}>Ù…Ø§Ù‡ Ø§Ø®ÛŒØ±</option>
            <option value="90" {% if period == '90' %}selected{% endif %}>3 Ù…Ø§Ù‡ Ø§Ø®ÛŒØ±</option>
            <option value="365" {% if period == '365' %}selected{% endif %}>Ø³Ø§Ù„ Ø§Ø®ÛŒØ±</option>
        </select>
        <button onclick="refreshDashboard()" class="btn btn-primary btn-sm">
            Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ
        </button>
    </div>
</div>

<!-- Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø¢Ù…Ø§Ø±ÛŒ -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
    <!-- Ú©Ù„ Ø³ÙØ§Ø±Ø´Ø§Øª -->
    <div class="stat stat-card shadow-lg rounded-2xl">
        <div class="stat-figure text-primary">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
            </svg>
        </div>
        <div class="stat-title">Ú©Ù„ Ø³ÙØ§Ø±Ø´Ø§Øª</div>
        <div class="stat-value text-primary">{{ "{:,}".format(total_orders) }}</div>
        <div class="stat-desc">{{ period_name }}: {{ "{:,}".format(period_orders) }}</div>
    </div>
    
    <!-- Ø¯Ø±Ø¢Ù…Ø¯ -->
    <div class="stat stat-card shadow-lg rounded-2xl">
        <div class="stat-figure text-secondary">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        </div>
        <div class="stat-title">Ø¯Ø±Ø¢Ù…Ø¯ {{ period_name }}</div>
        <div class="stat-value text-secondary">{{ "{:,}".format(period_revenue|int) }}</div>
        <div class="stat-desc">Ø§Ù…Ø±ÙˆØ²: {{ "{:,}".format(today_revenue|int) }} ØªÙˆÙ…Ø§Ù†</div>
    </div>
    
    <!-- Ù…Ø´ØªØ±ÛŒØ§Ù† -->
    <div class="stat stat-card shadow-lg rounded-2xl">
        <div class="stat-figure text-accent">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
            </svg>
        </div>
        <div class="stat-title">Ú©Ù„ Ù…Ø´ØªØ±ÛŒØ§Ù†</div>
        <div class="stat-value text-accent">{{ "{:,}".format(total_customers) }}</div>
        <div class="stat-desc">Ø¬Ø¯ÛŒØ¯: {{ "{:,}".format(new_customers) }}</div>
    </div>
    
    <!-- Ø¹Ø¯Ø³ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± -->
    <div class="stat stat-card shadow-lg rounded-2xl">
        <div class="stat-figure text-warning">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        </div>
        <div class="stat-title">Ø¹Ø¯Ø³ÛŒ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</div>
        <div class="stat-value text-warning">{{ "{:,}".format(pending_lenses) }}</div>
        <div class="stat-desc">ØªØ­ÙˆÛŒÙ„ Ø´Ø¯Ù‡: {{ "{:,}".format(delivered_lenses) }}</div>
    </div>
</div>

<!-- Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§ -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
    <!-- Ù†Ù…ÙˆØ¯Ø§Ø± Ø³ÙØ§Ø±Ø´Ø§Øª Ø±ÙˆØ²Ø§Ù†Ù‡ -->
    <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
            <div class="flex justify-between items-center mb-4">
                <h2 class="card-title">ğŸ“ˆ Ø³ÙØ§Ø±Ø´Ø§Øª Ø±ÙˆØ²Ø§Ù†Ù‡</h2>
                <select id="dailyChartDays" class="select select-bordered select-sm">
                    <option value="7">7 Ø±ÙˆØ²</option>
                    <option value="14">14 Ø±ÙˆØ²</option>
                    <option value="30">30 Ø±ÙˆØ²</option>
                </select>
            </div>
            <div class="chart-container">
                <canvas id="dailyOrdersChart"></canvas>
            </div>
        </div>
    </div>
    
    <!-- Ù†Ù…ÙˆØ¯Ø§Ø± ÙˆØ¶Ø¹ÛŒØª Ø³ÙØ§Ø±Ø´Ø§Øª -->
    <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
            <h2 class="card-title">ğŸ© ÙˆØ¶Ø¹ÛŒØª Ø³ÙØ§Ø±Ø´Ø§Øª</h2>
            <div class="chart-container">
                <canvas id="statusChart"></canvas>
            </div>
        </div>
    </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
    <!-- Ù†Ù…ÙˆØ¯Ø§Ø± Ø§ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ØªØ­ÙˆÛŒÙ„ Ø´Ø¯Ù‡ -->
    <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
            <div class="flex justify-between items-center mb-4">
                <h2 class="card-title">ğŸ“¦ Ø§ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ØªØ­ÙˆÛŒÙ„ Ø´Ø¯Ù‡</h2>
                <select id="deliveredChartDays" class="select select-bordered select-sm">
                    <option value="7">7 Ø±ÙˆØ²</option>
                    <option value="14">14 Ø±ÙˆØ²</option>
                    <option value="30">30 Ø±ÙˆØ²</option>
                </select>
            </div>
            <div class="chart-container">
                <canvas id="deliveredItemsChart"></canvas>
            </div>
        </div>
    </div>

    <!-- Ù†Ù…ÙˆØ¯Ø§Ø± Ù…Ø­Ø¨ÙˆØ¨â€ŒØªØ±ÛŒÙ† Ø¹Ø¯Ø³ÛŒâ€ŒÙ‡Ø§ -->
    <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
            <h2 class="card-title">ğŸ† Ù…Ø­Ø¨ÙˆØ¨â€ŒØªØ±ÛŒÙ† Ø¹Ø¯Ø³ÛŒâ€ŒÙ‡Ø§</h2>
            <div class="chart-container">
                <canvas id="popularLensesChart"></canvas>
            </div>
        </div>
    </div>
</div>

<!-- Ø¬Ø¯ÙˆÙ„ ÙˆØ¶Ø¹ÛŒØª Ø³ÙØ§Ø±Ø´Ø§Øª -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
    <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
            <h2 class="card-title">ğŸ“‹ Ø®Ù„Ø§ØµÙ‡ ÙˆØ¶Ø¹ÛŒØª</h2>
            <div class="overflow-x-auto">
                <table class="table table-zebra">
                    <thead>
                        <tr>
                            <th>ÙˆØ¶Ø¹ÛŒØª</th>
                            <th>ØªØ¹Ø¯Ø§Ø¯</th>
                            <th>Ø¯Ø±ØµØ¯</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for status in order_status %}
                        <tr>
                            <td>
                                <div class="badge badge-{{ status.color }}">{{ status.name }}</div>
                            </td>
                            <td class="font-bold">{{ "{:,}".format(status.count) }}</td>
                            <td>
                                <div class="flex items-center gap-2">
                                    <div class="w-16 bg-base-300 rounded-full h-2">
                                        <div class="bg-{{ status.color }} h-2 rounded-full" style="width: {{ status.percentage }}%"></div>
                                    </div>
                                    <span class="text-sm">{{ "%.1f"|format(status.percentage) }}%</span>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- Ø¢Ù…Ø§Ø± Ø³Ø±ÛŒØ¹ -->
    <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
            <h2 class="card-title">âš¡ Ø¢Ù…Ø§Ø± Ø³Ø±ÛŒØ¹</h2>
            <div class="space-y-4">
                <div class="flex justify-between items-center p-3 bg-base-200 rounded-lg">
                    <span class="font-medium">Ø³ÙØ§Ø±Ø´Ø§Øª Ø§Ù…Ø±ÙˆØ²</span>
                    <span class="badge badge-primary badge-lg">{{ "{:,}".format(today_orders) }}</span>
                </div>
                <div class="flex justify-between items-center p-3 bg-base-200 rounded-lg">
                    <span class="font-medium">Ø¯Ø±Ø¢Ù…Ø¯ Ø§Ù…Ø±ÙˆØ²</span>
                    <span class="badge badge-secondary badge-lg">{{ "{:,}".format(today_revenue|int) }}</span>
                </div>
                <div class="flex justify-between items-center p-3 bg-base-200 rounded-lg">
                    <span class="font-medium">Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ø³ÙØ§Ø±Ø´</span>
                    <span class="badge badge-accent badge-lg">
                        {% if period_orders > 0 %}
                            {{ "{:,}".format((period_revenue / period_orders)|int) }}
                        {% else %}
                            0
                        {% endif %}
                    </span>
                </div>
                <div class="flex justify-between items-center p-3 bg-base-200 rounded-lg">
                    <span class="font-medium">Ù†Ø±Ø® ØªÚ©Ù…ÛŒÙ„</span>
                    <span class="badge badge-success badge-lg">
                        {% set completed_count = order_status|selectattr('name', 'equalto', 'ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡')|list %}
                        {% if completed_count %}
                            {{ "%.0f"|format(completed_count[0].percentage) }}%
                        {% else %}
                            0%
                        {% endif %}
                    </span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Ø¬Ø¯ÙˆÙ„ Ø³ÙØ§Ø±Ø´Ø§Øª Ø§Ø®ÛŒØ± -->
<div class="card bg-base-100 shadow-xl">
    <div class="card-body">
        <div class="flex justify-between items-center mb-4">
            <h2 class="card-title">ğŸ“ Ø³ÙØ§Ø±Ø´Ø§Øª Ø§Ø®ÛŒØ±</h2>
            <a href="{{ url_for('orders.index') }}" class="btn btn-outline btn-sm">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù‡Ù…Ù‡</a>
        </div>
        <div class="overflow-x-auto">
            <table class="table table-zebra">
                <thead>
                    <tr>
                        <th>Ø´Ù…Ø§Ø±Ù‡</th>
                        <th>Ù…Ø´ØªØ±ÛŒ</th>
                        <th>ØªØ§Ø±ÛŒØ®</th>
                        <th>ÙˆØ¶Ø¹ÛŒØª</th>
                        <th>Ù…Ø¨Ù„Øº</th>
                        <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
                    </tr>
                </thead>
                <tbody>
                    {% for order in recent_orders %}
                    <tr class="hover">
                        <td class="font-mono">{{ order.order_number }}</td>
                        <td class="font-medium">{{ order.customer.full_name }}</td>
                        <td>{{ order.created_at.strftime('%Y/%m/%d') }}</td>
                        <td>
                            <div class="badge badge-{{ order.status_color }}">{{ order.status_display }}</div>
                        </td>
                        <td class="font-bold">{{ "{:,}".format(order.total_amount|int) }} ØªÙˆÙ…Ø§Ù†</td>
                        <td>
                            <div class="flex gap-1">
                                <a href="{{ url_for('orders.show', id=order.id) }}" class="btn btn-ghost btn-xs">Ù…Ø´Ø§Ù‡Ø¯Ù‡</a>
                                <a href="{{ url_for('orders.edit', id=order.id) }}" class="btn btn-ghost btn-xs">ÙˆÛŒØ±Ø§ÛŒØ´</a>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø³Ø±Ø§Ø³Ø±ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§
let dailyOrdersChart, statusChart, deliveredItemsChart, popularLensesChart;

// Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙØ±Ø¶
const colors = {
    primary: '#3b82f6',
    secondary: '#8b5cf6',
    accent: '#f59e0b',
    success: '#10b981',
    warning: '#f59e0b',
    error: '#ef4444',
    info: '#06b6d4'
};

// ØªØ§Ø¨Ø¹ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯
function refreshDashboard() {
    const period = document.getElementById('periodFilter').value;
    window.location.href = `{{ url_for('main.dashboard') }}?period=${period}`;
}

// ØªØ§Ø¨Ø¹ Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆØ¯Ø§Ø± Ø³ÙØ§Ø±Ø´Ø§Øª Ø±ÙˆØ²Ø§Ù†Ù‡
async function createDailyOrdersChart() {
    const days = document.getElementById('dailyChartDays').value || 7;

    try {
        const response = await fetch(`{{ url_for('main.api_daily_orders') }}?days=${days}`);
        const data = await response.json();

        const ctx = document.getElementById('dailyOrdersChart');
        if (ctx) {
            if (dailyOrdersChart) {
                dailyOrdersChart.destroy();
            }

            dailyOrdersChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'ØªØ¹Ø¯Ø§Ø¯ Ø³ÙØ§Ø±Ø´Ø§Øª',
                        data: data.orders,
                        borderColor: colors.primary,
                        backgroundColor: colors.primary + '20',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    }
                }
            });
        }
    } catch (error) {
        console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ù…ÙˆØ¯Ø§Ø± Ø³ÙØ§Ø±Ø´Ø§Øª Ø±ÙˆØ²Ø§Ù†Ù‡:', error);
        createSimpleChart();
    }
}

// ØªØ§Ø¨Ø¹ Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆØ¯Ø§Ø± ÙˆØ¶Ø¹ÛŒØª Ø³ÙØ§Ø±Ø´Ø§Øª
async function createStatusChart() {
    try {
        const response = await fetch('{{ url_for('main.api_status_chart') }}');
        const data = await response.json();

        const ctx = document.getElementById('statusChart');
        if (ctx) {
            if (statusChart) {
                statusChart.destroy();
            }

            statusChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: data.labels,
                    datasets: [{
                        data: data.data,
                        backgroundColor: data.colors,
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                        }
                    }
                }
            });
        }
    } catch (error) {
        console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ù…ÙˆØ¯Ø§Ø± ÙˆØ¶Ø¹ÛŒØª:', error);
        createSimpleStatusChart();
    }
}

// ØªØ§Ø¨Ø¹ Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆØ¯Ø§Ø± Ø§ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ØªØ­ÙˆÛŒÙ„ Ø´Ø¯Ù‡
async function createDeliveredItemsChart() {
    const days = document.getElementById('deliveredChartDays').value || 7;

    try {
        const response = await fetch(`{{ url_for('main.api_delivered_items') }}?days=${days}`);
        const data = await response.json();

        const ctx = document.getElementById('deliveredItemsChart');
        if (ctx) {
            if (deliveredItemsChart) {
                deliveredItemsChart.destroy();
            }

            deliveredItemsChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'ØªØ­ÙˆÛŒÙ„ Ø´Ø¯Ù‡',
                        data: data.delivered,
                        backgroundColor: colors.success + '80',
                        borderColor: colors.success,
                        borderWidth: 1
                    }, {
                        label: 'Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±',
                        data: data.pending,
                        backgroundColor: colors.warning + '80',
                        borderColor: colors.warning,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'ØªØ¹Ø¯Ø§Ø¯ Ø§ÛŒØªÙ…'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y + ' Ø¹Ø¯Ø¯';
                                }
                            }
                        }
                    }
                }
            });
        }
    } catch (error) {
        console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ù…ÙˆØ¯Ø§Ø± Ø§ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ØªØ­ÙˆÛŒÙ„ Ø´Ø¯Ù‡:', error);
        createSimpleDeliveredChart();
    }
}

// ØªØ§Ø¨Ø¹ Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆØ¯Ø§Ø± Ù…Ø­Ø¨ÙˆØ¨â€ŒØªØ±ÛŒÙ† Ø¹Ø¯Ø³ÛŒâ€ŒÙ‡Ø§
async function createPopularLensesChart() {
    try {
        const response = await fetch('{{ url_for('main.api_popular_lenses') }}');
        const data = await response.json();

        const ctx = document.getElementById('popularLensesChart');
        if (ctx) {
            if (popularLensesChart) {
                popularLensesChart.destroy();
            }

            popularLensesChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'ØªØ¹Ø¯Ø§Ø¯ ÙØ±ÙˆØ´',
                        data: data.data,
                        backgroundColor: colors.accent + '80',
                        borderColor: colors.accent,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'ØªØ¹Ø¯Ø§Ø¯ ÙØ±ÙˆØ´'
                            }
                        }
                    }
                }
            });
        }
    } catch (error) {
        console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ù…ÙˆØ¯Ø§Ø± Ø¹Ø¯Ø³ÛŒâ€ŒÙ‡Ø§:', error);
        createSimplePopularChart();
    }
}

// ØªØ§Ø¨Ø¹ Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆØ¯Ø§Ø± Ø³Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ³Øª
function createSimpleChart() {
    const ctx = document.getElementById('dailyOrdersChart');
    if (ctx) {
        const chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Ø´Ù†Ø¨Ù‡', 'ÛŒÚ©Ø´Ù†Ø¨Ù‡', 'Ø¯ÙˆØ´Ù†Ø¨Ù‡', 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡', 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡', 'Ù¾Ù†Ø¬â€ŒØ´Ù†Ø¨Ù‡', 'Ø¬Ù…Ø¹Ù‡'],
                datasets: [{
                    label: 'Ø³ÙØ§Ø±Ø´Ø§Øª',
                    data: [12, 19, 3, 5, 2, 3, 7],
                    borderColor: colors.primary,
                    backgroundColor: colors.primary + '20',
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });
    }
}

function createSimpleStatusChart() {
    const ctx2 = document.getElementById('statusChart');
    if (ctx2) {
        const chart2 = new Chart(ctx2, {
            type: 'doughnut',
            data: {
                labels: ['Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±', 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…', 'ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡', 'Ù„ØºÙˆ Ø´Ø¯Ù‡'],
                datasets: [{
                    data: [30, 20, 40, 10],
                    backgroundColor: [colors.warning, colors.info, colors.success, colors.error]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });
    }
}

function createSimpleDeliveredChart() {
    const ctx = document.getElementById('deliveredItemsChart');
    if (ctx) {
        const chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Ø´Ù†Ø¨Ù‡', 'ÛŒÚ©Ø´Ù†Ø¨Ù‡', 'Ø¯ÙˆØ´Ù†Ø¨Ù‡', 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡', 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡', 'Ù¾Ù†Ø¬â€ŒØ´Ù†Ø¨Ù‡', 'Ø¬Ù…Ø¹Ù‡'],
                datasets: [{
                    label: 'ØªØ­ÙˆÛŒÙ„ Ø´Ø¯Ù‡',
                    data: [15, 25, 8, 12, 18, 22, 10],
                    backgroundColor: colors.success + '80',
                    borderColor: colors.success,
                    borderWidth: 1
                }, {
                    label: 'Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±',
                    data: [5, 8, 12, 3, 7, 9, 15],
                    backgroundColor: colors.warning + '80',
                    borderColor: colors.warning,
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    }
}

function createSimplePopularChart() {
    const ctx = document.getElementById('popularLensesChart');
    if (ctx) {
        const chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Ø¹Ø¯Ø³ÛŒ A', 'Ø¹Ø¯Ø³ÛŒ B', 'Ø¹Ø¯Ø³ÛŒ C', 'Ø¹Ø¯Ø³ÛŒ D', 'Ø¹Ø¯Ø³ÛŒ E'],
                datasets: [{
                    label: 'ØªØ¹Ø¯Ø§Ø¯ ÙØ±ÙˆØ´',
                    data: [45, 38, 32, 28, 22],
                    backgroundColor: colors.accent + '80',
                    borderColor: colors.accent,
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y'
            }
        });
    }
}

// Event listeners
document.addEventListener('DOMContentLoaded', function() {
    // Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§
    createDailyOrdersChart();
    createStatusChart();
    createDeliveredItemsChart();
    createPopularLensesChart();

    // Event listener Ø¨Ø±Ø§ÛŒ ØªØºÛŒÛŒØ± ÙÛŒÙ„ØªØ± Ø±ÙˆØ²Ù‡Ø§ÛŒ Ù†Ù…ÙˆØ¯Ø§Ø± Ø±ÙˆØ²Ø§Ù†Ù‡
    const dailyChartDays = document.getElementById('dailyChartDays');
    if (dailyChartDays) {
        dailyChartDays.addEventListener('change', function() {
            createDailyOrdersChart();
        });
    }

    // Event listener Ø¨Ø±Ø§ÛŒ ØªØºÛŒÛŒØ± ÙÛŒÙ„ØªØ± Ø±ÙˆØ²Ù‡Ø§ÛŒ Ù†Ù…ÙˆØ¯Ø§Ø± Ø§ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ØªØ­ÙˆÛŒÙ„ Ø´Ø¯Ù‡
    const deliveredChartDays = document.getElementById('deliveredChartDays');
    if (deliveredChartDays) {
        deliveredChartDays.addEventListener('change', function() {
            createDeliveredItemsChart();
        });
    }

    // Event listener Ø¨Ø±Ø§ÛŒ ØªØºÛŒÛŒØ± ÙÛŒÙ„ØªØ± Ø¯ÙˆØ±Ù‡
    const periodFilter = document.getElementById('periodFilter');
    if (periodFilter) {
        periodFilter.addEventListener('change', function() {
            refreshDashboard();
        });
    }
});
</script>
{% endblock %}
